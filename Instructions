PREDICT Behavioral Repository: Instructions

***Unless otherwise noted, you will need to follow these instructions (in sequential order) every time you want to 
create a new report

Step 1: Open user-inputs.R script from the predict-behav-report folder

Step 2: Load packages needed to run reports: 
    ## Highlight and run lines 3 through 6

OPTIONAL step for Mac users (Window users can ignore):
* This only needs to be done ONCE and is required in order to run the site-maps script
  1. Install brew:
      In the Terminal, copy and paste the followoing line of code and press 'enter': 
      /usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
  2. Install gdal:
      In the Terminal, copy and paste the following line of code and press 'enter': 
      brew install gdal

Step 3: Enter country, illness, and taxa contact variables of interest (must be in quotations)

    ## line 10: country: select ONE country
    
    ## line 12: illness_outcomes: select up to 4 illness outcomes (separated by commas; note spelling)
            ### "sari", "ili", "encephalitis", "hemorrhagic_fever"
            ### these outcomes will be included in the tabular report and lasso report
            ### there is also the option to not enter any illness
            
    ## line 15: heatmap_taxa_outcomes: select up to 14 taxa outcomes (separated by commas; note spelling)
            ### "rodents", "bats", "nhp", "birds", "poultry", "carnivores", "ungulates", "pangolins",
             "goats_sheep", "camels", "swine", "cattle", "dogs", "cats"
            ### these outcomes will be included in the heatmap report
            ### at least one taxa MUST be included
            ### heatmap_taxa_outcomes <- taxa_names command will include all taxa
          
    ## line 19: tabular_lasso_taxa_outcomes: select up to 14 taxa types (separated by commas; note spelling)
            ### these outcomes will be included in the tabular report and lasso report
            ### "rodents", "bats", "nhp", "birds", "poultry", "carnivores", "ungulates", "pangolins",
             "goats_sheep", "camels", "swine", "cattle", "dogs", "cats"
            ### these outcomes will be included in the tabular report and lasso report
            ### there is also the option to not enter any taxa
             
  After selecting all of the user-entered parameters, highlight and run lines 10-19
      
             
Step 4: Confirm that illness_outcomes, heatmap_taxa_outcomes, tabular_lasso_taxa_outcomes: 
    ## Highlight and run lines 25-27
    
Step 5: Create discrete categories for continuous variables to run in the lasso
    ## Highlight and run lines 31-34

Step 6: Download EIDITH command: (NOT ALWAYS REQUIRED): line 39

    ## if run TRUE, eidith data will download (this is not always required and only necessary if there have
    been recent updates made to eidith)
    
    ## if run FALSE, the most recently downloaded version eidith will be used (recommended)

Step 7: Run Lasso command: (NOT ALWAYS REQUIRED): line 45

    ## if run TRUE, the lasso will run for all selected illness_outcomes and tabular_lasso_taxa_outcomes 
    
            ### Note 1: The lasso takes a long time to run (up to several hours in some cases); time to run is                increased  with more selected outcomes
            ### Note 2: Once the lasso has been run for a specific taxa or illness, it is saved in the outputs  
            folder and does not need to be run again
          
    ## if run FALSE, the lasso will not run (recommended)
    
            ### Note 1: You can still view the lasso report if you select FALSE - you just need to make sure that
            you have already run the lasso with your selected taxa and illness outcomes. This can be checked in
            the outputs/lasso-figs folder.
    
    
*** WARNING: If the outcomes of interest (taxa or illness) have low or no positive responses (low prevalence), then the lasso will ultimately fail (i.e. you will receive an error message when you try to create the lasso report). Prior to running the lasso, check that the prevalence of each outcome you selected is at least 10%. You can check prevalence for all of the taxa and illness outcomes by highlighting and running lines 49-56.

Step 8: Create csv files to be used in the reports: Highlight and run line 49
   
   ## Note: ff you selected download_fresh <- TRUE (line 39), a new version of eidith will download
   
            ### If this is your first time downloading EIDITH in R, you will be asked for your EIDITH_NAME
            and EIDTH_PASSWORD. These will only need to be entered once
        
            ### You will see the following message in the console:
        
                  Local EIDITH database is missing tables.
                  Would you like to download missing tables? 

                      1: Yes
                      2: No
                  
                    #### select: 2
                    #### this message will appear every time you select download_fresh <- TRUE
    
            ### csv files can be found in the data folder
    
Step 9: Select which reports you want to run: Highlight and run line 62

    ## Options include: "summary-report", "tabular-report". "site-maps", "heatmaps", "lasso"
  
Step 10: Create selected reports: Highlight and run line 66
        
    ## All reports can be found in the outputs/reports folder
    ## All figures can be found in their associated folder within the outputs folder
  
  
Additional Information  
  
*** Every time the illness_outcomes, heatmap_taxa_outcomes, and/or tabular_lasso_taxa_outcomes are changed in the user-inputs.R script, new Tabular reports, Heatmap reports, and Lasso reports are generated in the outputs/reports folder. Unless you change the country of analysis, the Summary report and Sitemaps report will remain the same.


APPENDIX

I. Variable Names
- this section provides the following information for some of the report variables:
    1. variable name (the variable name used in the report outputs)
    2. question name (the question as it appears in the human questionnaire)
    3. response options (response options for each question as they appear in the human questionnaire)
    4. any additional information about the variable (OPTIONAL)


crowding_index                             
N/A (is not explicitly asked in the questionnaire)             
# of people in dwelling (including respondent) /# of rooms in dwelling (excluding bathroom and kitchen)        a higher crowding index indicates a more crowded dwelling                   

dedicated_location_for_waste
In your dwelling is there a dedicated location for human sold waste/excreta?
yes; no

water_used_by_animals
Is your source for drinking water ever used by animals?
yes; no

treatment
Where do you usually get treatment for medical problems? Select all that apply
clinic/health center; hospital; mobile clinic; community health worker; traditional healer; dispensary or pharmacy



#Heatmaps
(types of taxa contact within previous year; all responses are yes/no)

slaughtered
Have you slaughtered an animal?

hunted/trapped
Have you hunted or trapped an animal?

scratched/bitten
Have you been scratched or bitten by an animal?

found dead/collected
Have found a dead animal and collected it to sell, eat, and/or share?

eaten sick
Have you eaten an animal that you know was not well/sick?

eaten raw/undercooked
Have you eaten raw or undercooked mear or organs or blood?

cooked/handled
Have you cooked or handled meat, orgrans or blood from a recently killed animal?

in house
Do any animals come inside the dwelling where you live?

feces in or near food
Have you seen animal feces in or near food before you have eaten it?

raised
Have you raised live animals?

handled
Have you handled live animals?

pets
Has an animal lived as a pet in or near your dwelling?


#Tabular reports

pet_in_dwelling_last_year
Has an animal lived as a pet in or near your dwelling?
yes; no

handle_animals_last_year
Have you handled live animals?
yes; no

raised_animals_last_year
Have you raised live animals?
yes; no

shared_water_last_year
Have you shared a water source with animals for washing?
yes; no; don't know
don't know recoded as 'no'

animal_feces_food_last_year
Have you seen animal feces in or near food before you have eaten it?
yes; no

animals_in_food_year
Have you eaten food after an animal has touched or damaged it?
yes; no; don't know
don't know recoded as 'no'

animals_in_dwelling_last_year
Do any animals come inside the dwelling where you live?
yes; no

cooked_meat_last_year
Have you cooked or handled meat, orgrans or blood from a recently killed animal?
yes; no

eaten_raw_meat_last_year
Have you eaten raw or undercooked mear or organs or blood?
yes; no

eaten_sick_animal_last_year
Have you eaten an animal that you know was not well/sick?
yes; no

eaten_dead_animal_last_year
Have found a dead animal and collected it to eat or share?
yes; no

sold_dead_animal_last_year
Have you found a dead animal and collected it to sell it?
yes; no

scratched_bitten_last_year
Have you been scratched or bitten by an animal?
yes; no

hunted_animal_last_year
Have you hunted or trapped an animal?
yes; no

slaughtered_animal_last_year
Have you slaughtered an animal?
yes; no

--- Additional taxa contact variables:

taxa_contact_any
includes: pets; handled; raised; feces in or near food; in house; cooked/handled; eaten raw/undercooked; 
eaten sick; found dead/collected; scratched/bitten; hunted/trapped; slaughtered

taxa_contact_direct
includes: pets; handled; raised; cooked/handled; eaten raw/undercooked; eaten sick; found dead/collected;
scratched/bitten; hunted/trapped; slaughtered

taxa_contact_indirect
includes: feces in or near food; in house

-------

scratched_bitten_action
The last time you were scratched or bitten, or cut yourself while butchering or slaughtering, what did you do?
treated; untreated; N/A
'treated' includes: wash wound with soap and water; visit doctor
'untreated' includes: let someone else take over; rinse wound with water; bandage wound; nothing - kept working
'N/A' includes: N/A; never butcher or slaughter


risk_open_wound
Are there any risks associated with slaughtering or butchering when you have an open wound
yes; no
'yes' includes: yes, but I don't know what they are; yes, it can make you sick; yes, it can poison you,
yes, it can infect you with a disease'
'no' includes: no; don't know; other


worried_about_disease
Are you worried about diseases or disease outbreaks in live animals at your local market?
yes; no



*** TO DO:
- can CI plots be similar sizes; the plots with long var names are very small (ex: occupation) (low)
- Egypt (low)

