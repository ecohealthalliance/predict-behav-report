---
params:
  country: "Indonesia"
title: '<span style="color:red;">DRAFT</span> Heatmaps: `r params$country`'
date: "`r Sys.Date()`"
output:
  html_document:
    keep_md: false
---

```{r setup, include=FALSE}
purrr::walk(list.files(here::here("R/"), full.names = TRUE),
            source, echo = FALSE, verbose = FALSE)

knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
country <- params$country

# Read in data
dat <- read_csv(h(paste0("data/raw-behav-", country, ".csv"))) 
ldat <- read_csv(h(paste0("data/logic-behav-", country, ".csv")))
```

<details>
<summary>Taxa Contact</summary>
```{r heatmap, fig.width = 15, fig.height = 7.5}
hm <- get_heatmap(ldat, title = "Taxa Contact")
ggsave(plot = hm, file = h("outputs/heatmap-figs", paste0(country, "-heat-map.png")), width = 15, height = 7.5, units = "in")
print(hm)
```
</details>

<details>
<summary>Taxa Contact by Gender</summary>
```{r heatmap-gender, fig.width = 15, fig.height = 7.5}
gender_dat <- bind_cols(dat %>% select(gender), ldat) %>%
  mutate(gender = factor(gender, levels = c("female", "male"), ordered =TRUE))
hm <- get_heatmap(gender_dat, group_var = "gender", title = "Taxa Contact by Gender")
ggsave(plot = hm, file = h("outputs/heatmap-figs", paste0(country, "-gender-heat-map.png")), width = 15, height = 7.5, units = "in")
print(hm)
```
</details>

<details>
<summary>Taxa Contact by Education</summary>
```{r heatmap-edu, fig.width = 15, fig.height = 15}
edu_dat <- bind_cols(dat %>% select(highest_education), ldat) %>%
  mutate(highest_education = factor(highest_education, levels = c("none", "primary school", "secondary school", "college/university/professional"), ordered = TRUE))
hm <- get_heatmap(edu_dat, group_var = "highest_education", title = "Taxa Contact by Education")
ggsave(plot = hm, file = h("outputs/heatmap-figs", paste0(country, "-educ-heat-map.png")), width = 15, height = 15, units = "in")
print(hm)
```
</details>

